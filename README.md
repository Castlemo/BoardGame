# 모두의 마블 2.0

> Java Swing 기반 보드게임 | 로컬 & LAN 멀티플레이 지원

---

## 빠른 시작

```bash
./run.sh
# 또는
javac -d out -encoding UTF-8 $(find src -name "*.java")
java -cp out com.marblegame.Main
```

**요구사항**: JDK 17+ (외부 의존성 없음)

---

## 게임 모드

### 로컬 게임
- 동일 기기에서 2-4명 플레이
- 게임 시작 시 "로컬 게임" 선택

### LAN 멀티플레이
- 같은 WiFi/공유기 사용자끼리 플레이
- TCP 소켓 기반 실시간 동기화

**호스트 (방 만들기)**
1. 네트워크 멀티플레이 → 방 만들기
2. 화면에 표시된 LAN IP 확인 (예: `192.168.0.10`)
3. 다른 플레이어에게 IP 공유
4. 대기실에서 "게임 시작" 클릭

**클라이언트 (방 참가)**
1. 네트워크 멀티플레이 → 방 참가
2. 호스트의 LAN IP 입력
3. 포트 확인 (기본: 9999)
4. "참가" 클릭

---

## 게임 규칙

| 항목 | 내용 |
|------|------|
| 보드 | 9x9 외곽 32칸 (순환형) |
| 시작 자금 | 1,500,000원 |
| 월급 | START 통과 시 200,000원 |
| 업그레이드 | 레벨 0-4 (레벨 4 = 랜드마크) |
| 통행료 배율 | Lv0(1x) → Lv1(2x) → Lv2(4x) → Lv3(8x) → Lv4(16x) |
| 컬러 독점 | 같은 색상 모든 도시 소유 시 통행료 1.5배 |

### 승리 조건
- **파산 승리**: 다른 모든 플레이어 파산
- **라인 독점**: 한 면(8칸)의 모든 도시 독점
- **3색 독점**: 3개 이상의 컬러 그룹 독점

### 특수 타일

| 타일 | 효과                           |
|------|------------------------------|
| START | 월급 지급, 원하는 칸 업그레이드           |
| 도시 | 구매/업그레이드/인수/통행료              |
| 관광지 | 고정 가격, 잠금 또는 Extra Chance 선택 |
| 찬스 | 보상 (10만)                     |
| 국세청 | 현금의 10% 납부                   |
| 무인도 | 2턴 대기 또는 보석금 20만원 탈출         |
| 올림픽 | 소유 도시 1곳 통행료 2배 (1회)         |
| 세계여행 | 다음 턴 원하는 칸 이동                |

### 특수 룰

- **페이즈 딜리트**: 3턴마다 비어있는 도시 1개 랜덤 삭제
- **랜드마크 마그네틱**: 랜드마크 도착 시 양옆 4칸 내 플레이어 끌어와 통행료 징수
- **주사위 게이지**: 길게 눌러 원하는 합계 범위 선택 가능

---

## 조작법

| 액션 | 설명 |
|------|------|
| 주사위 굴리기 | 버튼 클릭 또는 길게 눌러 게이지 사용 |
| 매입 | 미소유 땅 도착 시 구매 |
| 업그레이드 | 본인 땅 도착 시 레벨업 |
| 인수 | 타인 땅 통행료 지불 후 인수 |
| 패스 | 현재 턴 액션 스킵 |

---

## 프로젝트 구조

```
src/com/marblegame/
├── Main.java                 # 진입점
├── core/
│   ├── GameUI.java           # 메인 컨트롤러 + 네트워크 통합
│   └── RuleEngine.java       # 게임 규칙 엔진
├── model/
│   ├── Board.java            # 32칸 보드
│   ├── City.java             # 도시 타일
│   ├── TouristSpot.java      # 관광지 타일
│   ├── Player.java           # 플레이어
│   ├── Dice.java             # 주사위
│   └── DiceGauge.java        # 게이지 모델
├── ui/
│   ├── UIConstants.java      # 중앙 집중식 UI 상수
│   ├── GameFrame.java        # 메인 프레임
│   ├── BoardPanel.java       # 보드 렌더링
│   ├── OverlayPanel.java     # 플레이어 정보 오버레이
│   ├── ActionPanel.java      # 액션 버튼 패널
│   └── *Dialog.java          # 게임 다이얼로그 (20+ 종류)
└── network/                  # LAN 멀티플레이
    ├── server/               # 서버 (호스트)
    ├── client/               # 클라이언트
    ├── protocol/             # 메시지 프로토콜
    ├── sync/                 # 상태 동기화
    └── ui/                   # 네트워크 UI
```

---

## 기술 스택

- **언어**: Java 17
- **UI**: Swing (커스텀 다크 테마, UIConstants 중앙 관리)
- **네트워크**: TCP Socket (Server-Client)
- **직렬화**: 커스텀 JSON (외부 라이브러리 미사용)
- **동기화**: GameStateSnapshot 기반 상태 전파
- **UI 아키텍처**: 중앙 집중식 상수 관리 (20+ 다이얼로그 통합)

---

## 네트워크 기능 (LAN)

### 구현된 기능
- 방 생성/참가 및 대기실
- 게임 상태 완전 동기화 (플레이어, 보드, 턴)
- 15개 게임 이벤트 실시간 전파
- 하트비트 모니터링 (5초 PING, 15초 타임아웃)
- 연결 끊김 시 자동 파산 처리
- 게임 종료/재시작 동기화

### 알려진 제한사항
- LAN 전용
- 방화벽이 포트 차단 시 수동 허용 필요
- 연결 끊김 후 재연결 미지원

---

## UI 시스템

### 다크 테마
모든 UI가 일관된 다크 테마를 사용합니다.
- 배경: 어두운 회색 (#202124)
- 텍스트: 밝은 회색 (#E8EAED)
- 버튼: 색상별 구분 (녹색=확인, 주황=업그레이드, 보라=인수)

### UIConstants (중앙 집중식 관리)
모든 색상, 폰트, 크기가 `UIConstants.java`에서 통합 관리됩니다.

**장점**:
- 일관된 디자인 유지
- 유지보수 용이
- 테마 변경 시 한 곳만 수정
- 중복 코드 제거

**적용된 다이얼로그** (20+ 종류):
- 게임 정보: DoubleDialog, ChanceDialog, IslandDialog
- 금융 정보: TaxPaymentDialog, TollPaymentDialog, TakeoverConfirmDialog
- 선택 UI: CitySelectionDialog, LevelSelectionDialog, GameModeDialog
- 특수 효과: OlympicDialog, LandmarkMagneticDialog, WorldTourDialog

---

## 라이선스

이 프로젝트는 교육 및 개인 사용 목적으로 제작되었습니다.
